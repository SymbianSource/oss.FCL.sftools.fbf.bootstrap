<?xml version="1.0" encoding="UTF-8"?>
<project name="SF-BOOTSTRAP" default="bootstrap" xmlns:hlm="http://www.nokia.com/helium">


    <property name="sbs.tools.src.path" value="e:\build_e\varamana\sbs-source-dir"/>
    <property name="sbs.zip.file" value="sbs_2.4.0_with_nokia_cfgs.zip"/>    
    
    <!-- location of Hg bootstrap repositories -->
    <property name="sf.config.repository"       value="d:\TB91_releases\sf-new\hg-sf-helium-config" />
    
    <!-- call this project -->
    <property name="platform.config.repository" value="d:\TB91_releases\sf-new\hg-platform-config" />
    
    <!-- the build dir to put bootstrap files into -->
    <property name="bootstrap.base.dir" value="d:\TB91_releases\sf-new\build\" />

    <import file="${helium.dir}/helium.ant.xml" />    
    <!-- <target name="bootstrap" depends="init,get-sf-config,get-sbs-tools,get-platform-config" />-->

    <target name="bootstrap" depends="init,get-sf-config,get-platform-config" />

    <target name="init">
        <mkdir dir="${bootstrap.base.dir}" />
        <mkdir dir="${bootstrap.base.dir}/build" />
        <mkdir dir="${bootstrap.base.dir}/build/config" />
    </target>
    <target name="clean-env">
        <echo message="cleaning up the environment" />
        <delete dir="${bootstrap.base.dir}/" />
    </target>

    <target name="get-sf-config">
        <!-- remove jars once cleared for subcon 
        <classpath>
            <pathelement location="D:/helium-3.44/helium-3.44.x/helium/external/antlibs/internal/maven-scm-api-1.1.jar"/>
            <pathelement location="D:/helium-3.44/helium-3.44.x/helium/external/antlibs/internal/maven-scm-provider-svn-commons-1.1.jar"/>
            <pathelement location="D:/helium-3.44/helium-3.44.x/helium/external/antlibs/internal/maven-scm-provider-synergy-1.1.jar"/>
            <pathelement location="D:/helium-3.44/helium-3.44.x/helium/external/antlibs/internal/maven-scm-provider-hg-1.1.jar"/>
        </classpath>
        -->
        <echo message="Getting sf helium configuration from repository ${sf.config.repository}" />
        <hlm:scm verbose="true" scmUrl="scm:hg:${sf.config.repository}">
            <hlm:checkout basedir="${bootstrap.base.dir}/sf-config"/>
        </hlm:scm>
    </target>

    <target name="get-sbs-tools">
    	<if>
    		<not><available file="${bootstrap.base.dir}/sbs"/></not>
    		<then>
                <echo message="Extracting sbs tools ${sbs.tools.src.path}/${sbs.zip.file}" />
    			<unzip src="${sbs.tools.src.path}/${sbs.zip.file}" dest="${bootstrap.base.dir}" />
                <echo message="Updating sbs tools path to batch file" />
        	    <echo file="${bootstrap.base.dir}/build/env.bat" append="true" >set SBS_HOME=${bootstrap.base.dir}\sbs
set PATH=${bootstrap.base.dir}\sbs\bin;${bootstrap.base.dir}\sbs\win32\mingw\bin;${bootstrap.base.dir}\sbs\win32\cygwin\bin;%PATH%
        	    </echo>
    		</then>
   	    </if>
    </target>

    <target name="get-platform-config">
        
     
        
        <echo message="Getting platform configuration${platform.config.repository}" />
        <hlm:scm verbose="true" scmUrl="scm:hg:${platform.config.repository}">
            <hlm:checkout basedir="${bootstrap.base.dir}/build/config"/>
        </hlm:scm>
    </target>
</project>